/*! 2024-03-08 */
KISSY.add("UFO/util/Storage",function(t,e){return{setItem:function(t,e,n){var a=typeof n;"string"==a||"number"==a||"boolean"==a?t.setItem(e,n):t.setItem(e,JSON.stringify(n))},getItem:function(e,t){e=e.getItem(t);try{return JSON.parse(e)}catch(t){return e}},setLocalItem:function(t,e){this.setItem(localStorage,t,e)},getLocalItem:function(t){return this.getItem(localStorage,t)},setSessionItem:function(t,e){this.setItem(sessionStorage,t,e)},getSessionItem:function(t){return this.getItem(sessionStorage,t)}}},{requires:["node"]}),KISSY.add("app/util/ParamUtil",function(a){return{processParam:function(t){for(var e in t){var n=t[e];a.isArray(n)&&(t[e]=n[0])}return t}}}),KISSY.add("UFO/core/lang/Number",function(t){return{toSignedNumberString:function(t,e){return 0<t?"+"+String(t):0==t?(e||"")+String(t):String(t)},toHex:function(t){return t.toString(16)},toAmountWords:function(t){for(var e=["","万","亿"],n=["拾","佰","仟"],a=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],r=String(t).split("."),i=0,s=0,o=0,c="",u=0,l=1,d=r[0].length;l<=d;l++){var u=r[0].charAt(d-l),m=0;0<=d-l-1&&(m=r[0].charAt(d-l-1)),0!=(o+=Number(u))&&(c=a[Number(u)].concat(c),"0"==u)&&(o=0),0<=d-l-1&&(3!=i?(0!=m&&(c=n[i].concat(c)),i++):("万"!=c.charAt(i=0)&&"亿"!=c.charAt(0)||(c=c.substr(1,c.length-1)),c=e[s].concat(c),o=0)),3==i&&s++}return c+="元",r[1]?(0!=(u=r[1].charAt(0))&&(c+=a[Number(u)]+"角"),0!=(u=r[1].charAt(1))&&(c+=a[Number(u)]+"分")):c+="整",c}}}),KISSY.add("UFO/core/lang/Date",function(t,s){return{getMonthName:function(t,e){return(!0===e?["&#74;&#97;&#110;","&#70;&#101;&#98;","&#77;&#97;&#114;","&#65;&#112;&#114;","&#77;&#97;&#121;","&#74;&#117;&#110;","&#74;&#117;&#108;","&#65;&#117;&#103;","&#83;&#101;&#112;","&#79;&#99;&#116;","&#78;&#111;&#118;","&#68;&#101;&#99;"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"])[t.getMonth()]},getWeekName:function(t,e){return(!0===e?["&#83;&#117;&#110;","&#77;&#111;&#110;","&#84;&#117;&#101;","&#87;&#101;&#100;","&#84;&#104;&#117;&#114;","&#70;&#114;&#105;","&#83;&#97;&#116;"]:["Sun","Mon","Tue","Wed","Thur","Fri","Sat"])[t.getDay()]},format:function(t,e){if(!t)return"";e=e||"yyyy-MM-dd mm:ss";var n,a,r,i={TZ:s.toSignedNumberString(parseInt(-t.getTimezoneOffset()/60)),"q+":Math.floor((t.getMonth()+3)/3),"y+":t.getFullYear(),MN:this.getMonthName(t,!0),"M+":t.getMonth()+1,"d+":t.getDate(),WN:this.getWeekName(t),"h+":t.getHours(),"H+":(n=t.getHours())<13?n:n-12,"m+":t.getMinutes(),MP:t.getMinutes()-(new Date).getMinutes(),"s+":t.getSeconds(),DP:t.getHours()<12?"AM":"PM"};for(a in i)new RegExp("("+a+")").test(e)&&(r=RegExp.$1,e=e.replace(r,function(){return"yy"===r?i[a]%100:1<r.length&&"number"==typeof i[a]&&-1<i[a]&&i[a]<10?"0"+i[a]:i[a]}));return e}}},{requires:["./Number"]}),KISSY.add("app/util/XTemplateUtil",function(r,t,i){return t.addCommand("getImgAbsolutePath",function(t,e){e=e.params[0];return e?"../resources/img/"+e:"../resources/img/default_product.png"}),t.addCommand("formatPrice",function(t,e){return Number(e.params[0]).toFixed(2)}),t.addCommand("formatDateTime",function(t,e){var n=e.params[0],a="yyyy-MM-dd";return r.isNumber(n)&&(n=new Date(n)),2===e.params.length&&(a=e.params[1]),i.format(n,a)}),t.addCommand("fixedDigits",function(t,e){var n=2;return 2===e.params.length&&(n=e.params[1]),Number(e.params[0]).toFixed(n)}),t.addCommand("join",function(t,e){var n=",";return 2===e.params.length&&(n=e.params[1]),e.params[0].join(n)}),t.addCommand("getHost",function(t,e){return location.host}),t.addCommand("encodeURIComponent",function(t,e){return encodeURIComponent(e.params[0])}),{}},{requires:["xtemplate","UFO/core/lang/Date"]}),KISSY.add("app/app",function(t,e,n,a){var r=n.processParam(t.unparam(decodeURIComponent(location.search.slice(1)))),i=(navigator.userAgent.toLowerCase(),"yql_user"),n=void 0;return 0<(t=location.pathname.lastIndexOf("build/"))?n=location.pathname.substring(0,t)+"build/data":0<(t=location.pathname.lastIndexOf("src/"))&&(n=location.pathname.substring(0,t)+"src/data"),console.log("api_path",n),{API_HOST:location.protocol+"//"+location.host+n,IMG_BASE_URL:"./resources/img",VERSION:"1.0.0",setSessionUser:function(t){e.setSessionItem(i,t)},getSessionUser:function(){return e.getSessionItem(i)},isLogined:function(){return!!this.getSessionUser()},getParam:function(){return r},isMicroMessenger:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},notifyApp:function(t,e){var n,a=navigator.userAgent;"micromessenger"==a.toLowerCase().match(/MicroMessenger/i)?window.location="down.html":(a.match(/(iPhone|iPod|iPad);?/i)?window.location=t:a.match(/android/i)&&(window.location=e),n=+new Date,setTimeout(function(){window.document.webkitHidden||setTimeout(function(){+new Date-n<2e3&&(window.location="down.html")},500)},500))}}},{requires:["UFO/util/Storage","./util/ParamUtil","./util/XTemplateUtil"]}),KISSY.add("app/Action",function(c,t,u){var l=c;return{ajax2:function(t){c.mix(t,{dataType:"json",headers:{"X-Requested-With":!1}},!1);var e=u.getSessionUser();return e&&(t.data=c.mix({user_id:e.user_id,token:e.token},t.data)),t.data=c.mix({version:u.version},t.data),l.io(t)},ajax:function(t){return t.url=u.API_HOST+t.url,this.ajax2(t)},query:function(t,e,n,a){return this.ajax({type:"GET",url:t,data:e,success:n,error:function(t){a&&a(t),alert("网络错误"),console.error(t)}})},post:function(t,e,n,a){return this.ajax({type:"post",url:t,data:e,success:n,error:function(t){a&&a(t),alert("网络错误"),console.error(t)}})},update:function(t,e,n,a){return this.post(t,e,n,a)},uploadImage2:function(t){var e=new XMLHttpRequest,n=(t.updateProgress&&e.addEventListener("progress",t.updateProgress,!1),t.success&&e.addEventListener("load",t.success,!1),t.error&&e.addEventListener("error",t.error,!1),t.transferCanceled&&e.addEventListener("abort",t.transferCanceled,!1),new FormData);n.append("uploadImage",t.file),e.open("post",u.API_HOST+"/v2/upload_image",!0),e.send(n)},postFormData:function(t,e,n,a){c.isString(t)?r={}:(t=(r=t).url,e=r.data,n=r.success,a=r.error);var r,i,s=u.getSessionUser(),o=(s&&c.mix(e,{user_id:s.user_id,token:s.token},!1),new FormData);for(i in e)o.append(i,e[i]);return c.mix(r,{type:"post",url:u.API_HOST+t,data:o,dataType:"json",headers:{"X-Requested-With":!1},cache:!1,contentType:!1,processData:!1,success:n,error:a}),l.io(r)}}},{requires:["io","./app"]}),KISSY.add("app/example/tpl/artisan-detail-tpl",function(){return'<div class="main artisan-view">\n\t<header class="bar-love header bar">\n\t\t<a class="button button-clear button-back" href="javascript:history.go(-1);">\n\t\t\t<i class="icon iconfont icon-back"></i>\n\t\t</a>\n\t\t<h1 class="title">{{title}}</h1>\n\t\t<div class="buttons buttons-right" style="-webkit-transition-duration: 0ms; transition-duration: 0ms;">\t\n\t\t</div>\n\t</header>\n\t<div class="content has-header">\n\t</div>\n</div>'}),KISSY.add("app/example/tpl/artisan-detail-content-tpl",function(){return'<section>\n\t\t<div class="item item-thumbnail-left item-header">\n\t\t\t<a class="item-image" data-url="{{#if large_avatar}}{{large_avatar}}{{else}}{{avatar}}{{/if}}" style="left:0;" href="javascript:;">\n\t\t\t<img class="header-img" src="{{#if avatar}}{{getImgAbsolutePath avatar}}{{else}}../resources/img/default.png{{/if}}"> </a>\n\t\t\t<div class="item-detail">\n\t\t\t\t<h3 class="name">{{name}}</h3>\n\t\t\t\t<a href="javascript:;" class="star-info">\n\t\t\t\t\t{{#if artisan_level}}\n\t\t\t\t\t<img src="../resources/img/star/{{artisan_level*0.5}}.gif" style="width:{{calWidth artisan_level}}px;"> \n\t\t\t\t\t{{/if}}\n\t\t\t\t\t{{#if artisan_glory}}<img src="../resources/img/star/glory.jpg" style="width: 20px; margin-top:3px; margin-left:-7px;" >{{/if}}\n\t\t\t\t\t({{artisan_level_value}})\n\t\t\t\t</a>\n\t\t\t\t<div class="flex row-center detail">\n\t\t\t\t\t<span class="price">均价:￥{{ave_price}}</span>\n\t\t\t\t\t<span class="time">接单数:{{service_times}}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\n\t\t<ul class="item item-score flex row-divid-line-col" style="padding-top:10px; padding-bottom:10px;">\n\t\t\t<li class="col">专业：<i class="i1">{{fixedDigits score_skill}}</i></li>\n\t\t\t<li class="col">沟通：<i class="i2">{{fixedDigits score_communication}}</i></li>\n\t\t\t<li class="col">守时：<i class="i3">{{fixedDigits score_punctuality}}</i></li>\n\t\t</ul>\n\t\t{{#if store_serial}}\n\t\t<a class="item  item-icon-right" href="./shopDisplay.html?store_serial={{store_serial}}&isApp={{isApp}}">\n\t\t  <label class="item-label">来自：</label>\n\t\t  {{store_name}}\n\t\t\t<i class="icon iconfont icon-forward"></i>\n\t\t</a>\n\t\t{{/if}}\n\t</section>\t'}),KISSY.add("app/example/mods/ArtisanDetail",function(a,t,r,e,n,i,s,o){var c=i.getParam();return{init:function(){var t=this.el=a.one(new r(s).render({title:"手艺人详情"}));this.content=t.one(".content"),this.render(),a.one(document.body).append(t),this.attachEvents()},render:function(){var n=this;e.query("/artisan.json",{artisan_id:c.artisan_id,city:"110100"},function(t){var e=t.data;console.log("artisan_detail",t),n.content.append(new r(o,{commands:{calWidth:function(t,e){return 20*Math.round(.5*e.params[0])},notEmpty:function(t,e){return a.isEmptyObject(e.params[0])?"":e.fn(t)}}}).render(e))})},attachEvents:function(){this.el.delegate("click",".item-header a.item-image",function(t){alert("我点击了手艺人头像")})}}},{requires:["node","xtemplate","../../Action","../../util/XTemplateUtil","../../app","../tpl/artisan-detail-tpl","../tpl/artisan-detail-content-tpl"]});